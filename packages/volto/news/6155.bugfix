Revisit login/logout process, better catching of edge cases @sneridagh
