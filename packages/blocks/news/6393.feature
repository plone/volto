Implement the BMv3 changes from the blocks edit PR. @sneridagh
